= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = Q1 와인 클래스에 대한 KNN 알고리즘 적용 = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =


= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = # 1.1 MAKE WINE DATAFRAME = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
wine_df.head(): 
   Class  Alcohol  Malic acid   Ash  Alcalinity of ash  Magnesium  Total phenols  Flavanoids  Nonflavanoid phenols  Proanthocyanins  Color intensity   Hue  OD280/OD315 of diluted wines  Proline
0      1    14.23        1.71  2.43               15.6        127           2.80        3.06                  0.28             2.29             5.64  1.04                          3.92     1065
1      1    13.20        1.78  2.14               11.2        100           2.65        2.76                  0.26             1.28             4.38  1.05                          3.40     1050
2      1    13.16        2.36  2.67               18.6        101           2.80        3.24                  0.30             2.81             5.68  1.03                          3.17     1185
3      1    14.37        1.95  2.50               16.8        113           3.85        3.49                  0.24             2.18             7.80  0.86                          3.45     1480
4      1    13.24        2.59  2.87               21.0        118           2.80        2.69                  0.39             1.82             4.32  1.04                          2.93      735




= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 1.2 WINE DESCRIBE = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
wine_df.describe(): 
            Class     Alcohol  Malic acid         Ash  Alcalinity of ash   Magnesium  Total phenols  Flavanoids  Nonflavanoid phenols  Proanthocyanins  Color intensity         Hue  OD280/OD315 of diluted wines      Proline
count  178.000000  178.000000  178.000000  178.000000         178.000000  178.000000     178.000000  178.000000            178.000000       178.000000       178.000000  178.000000                    178.000000   178.000000
mean     1.938202   13.000618    2.336348    2.366517          19.494944   99.741573       2.295112    2.029270              0.361854         1.590899         5.058090    0.957449                      2.611685   746.893258
std      0.775035    0.811827    1.117146    0.274344           3.339564   14.282484       0.625851    0.998859              0.124453         0.572359         2.318286    0.228572                      0.709990   314.907474
min      1.000000   11.030000    0.740000    1.360000          10.600000   70.000000       0.980000    0.340000              0.130000         0.410000         1.280000    0.480000                      1.270000   278.000000
25%      1.000000   12.362500    1.602500    2.210000          17.200000   88.000000       1.742500    1.205000              0.270000         1.250000         3.220000    0.782500                      1.937500   500.500000
50%      2.000000   13.050000    1.865000    2.360000          19.500000   98.000000       2.355000    2.135000              0.340000         1.555000         4.690000    0.965000                      2.780000   673.500000
75%      3.000000   13.677500    3.082500    2.557500          21.500000  107.000000       2.800000    2.875000              0.437500         1.950000         6.200000    1.120000                      3.170000   985.000000
max      3.000000   14.830000    5.800000    3.230000          30.000000  162.000000       3.880000    5.080000              0.660000         3.580000        13.000000    1.710000                      4.000000  1680.000000




= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 1.3 TRAIN TEST SET = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
y.head(): 
0    1
1    1
2    1
3    1
4    1
Name: Class, dtype: int64


X_train.head(): 
     Alcohol  Malic acid   Ash  Alcalinity of ash  Magnesium  Total phenols  Flavanoids  Nonflavanoid phenols  Proanthocyanins  Color intensity   Hue  OD280/OD315 of diluted wines  Proline
74     11.96        1.09  2.30               21.0        101           3.38        2.14                  0.13             1.65             3.21  0.99                          3.13      886
56     14.22        1.70  2.30               16.3        118           3.20        3.00                  0.26             2.03             6.38  0.94                          3.31      970
15     13.63        1.81  2.70               17.2        112           2.85        2.91                  0.30             1.46             7.30  1.28                          2.88     1310
106    12.25        1.73  2.12               19.0         80           1.65        2.03                  0.37             1.63             3.40  1.00                          3.17      510
40     13.56        1.71  2.31               16.2        117           3.15        3.29                  0.34             2.34             6.13  0.95                          3.38      795


X_test.head(): 
     Alcohol  Malic acid   Ash  Alcalinity of ash  Magnesium  Total phenols  Flavanoids  Nonflavanoid phenols  Proanthocyanins  Color intensity   Hue  OD280/OD315 of diluted wines  Proline
127    11.79        2.13  2.78               28.5         92           2.13        2.24                  0.58             1.76             3.00  0.97                          2.44      466
66     13.11        1.01  1.70               15.0         78           2.98        3.18                  0.26             2.28             5.30  1.12                          3.18      502
161    13.69        3.26  2.54               20.0        107           1.83        0.56                  0.50             0.80             5.88  0.96                          1.82      680
125    12.07        2.16  2.17               21.0         85           2.60        2.65                  0.37             1.35             2.76  0.86                          3.28      378
152    13.11        1.90  2.75               25.5        116           2.20        1.28                  0.26             1.56             7.10  0.61                          1.33      425


y_train.head(): 
74     2
56     1
15     1
106    2
40     1
Name: Class, dtype: int64


y_test.head(): 
127    2
66     2
161    3
125    2
152    3
Name: Class, dtype: int64




= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 1.4 ~ 1.6 TRAIN KNEIGHBORSCLASSIFIER MODEL / N_NEIGHBORS=5 = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
n_neighbors: 5
Score_with_train_set: 80.65%
wine_knn_5.score(X_train, y_train): 
0.8064516129032258


Score_with_train_set: 72.22%
wine_knn_5.score(X_test, y_test): 
0.7222222222222222




= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 1.7 TRAIN KNEIGHBORSCLASSIFIER MODEL / N_NEIGHBORS=3 = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
n_neighbors: 3
Score_with_train_set: 85.48%
wine_knn_5.score(X_train, y_train): 
0.8064516129032258


Score_with_train_set: 70.37%
wine_knn_5.score(X_test, y_test): 
0.7222222222222222




= = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = 1.8 CHANGE X DATA = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =
X: 
     Alcohol  Malic acid   Ash  Alcalinity of ash
0      14.23        1.71  2.43               15.6
1      13.20        1.78  2.14               11.2
2      13.16        2.36  2.67               18.6
3      14.37        1.95  2.50               16.8
4      13.24        2.59  2.87               21.0
..       ...         ...   ...                ...
173    13.71        5.65  2.45               20.5
174    13.40        3.91  2.48               23.0
175    13.27        4.28  2.26               20.0
176    13.17        2.59  2.37               20.0
177    14.13        4.10  2.74               24.5

[178 rows x 4 columns]


X_train.head(): 
     Alcohol  Malic acid   Ash  Alcalinity of ash
148    13.32        3.24  2.38               21.5
25     13.05        2.05  3.22               25.0
89     12.08        1.33  2.30               23.6
30     13.73        1.50  2.70               22.5
146    13.88        5.04  2.23               20.0


X_test.head(): 
     Alcohol  Malic acid   Ash  Alcalinity of ash
123    13.05        5.80  2.13               21.5
149    13.08        3.90  2.36               21.5
36     13.28        1.64  2.84               15.5
114    12.08        1.39  2.50               22.5
116    11.82        1.47  1.99               20.8


y_train.head(): 
148    3
25     1
89     2
30     1
146    3
Name: Class, dtype: int64


y_test.head(): 
123    2
149    3
36     1
114    2
116    2
Name: Class, dtype: int64


n_neighbors: 
5


Score_with_train_set: 82.26%
wine_knn_5.score(X_train, y_train): 
0.8225806451612904


Score_with_train_set: 77.78%
wine_knn_5.score(X_test, y_test): 
0.7777777777777778


n_neighbors: 3
Score_with_train_set: 81.45%
wine_knn_3.score(X_train, y_train): 
0.8145161290322581


Score_with_train_set: 77.78%
wine_knn_3.score(X_test, y_test): 
0.7777777777777778


